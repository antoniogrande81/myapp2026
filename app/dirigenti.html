<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dirigenti - MyApp Sindacato Carabinieri</title>
</head>
<body class="flex flex-col min-h-screen font-sans">

    <!-- Loading Spinner -->
    <!-- ... codice invariato ... -->

    <!-- Header -->
    <!-- ... codice invariato ... -->

    <!-- Main Content -->
    <main class="flex-1 px-4 pb-32 sm:pb-24 md:pb-20">
        <div class="w-full max-w-md md:max-w-2xl lg:max-w-3xl xl:max-w-4xl mx-auto space-y-8 px-2 sm:px-4">
            <!-- Search Bar -->
            <!-- ... codice invariato ... -->

            <!-- Filter Tabs -->
            <div class="filter-tabs overflow-x-auto whitespace-nowrap flex-wrap sm:flex-nowrap">
                <!-- ... tabs invariati ... -->
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8">
                <!-- ... card statistiche invariato ... -->
            </div>

            <!-- Dirigenti List -->
            <div id="dirigentiContainer" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <!-- Skeleton e dirigenti caricati qui -->
            </div>

            <!-- Empty State -->
            <!-- ... codice invariato ... -->
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 px-4 py-3 bg-white backdrop-blur-md border-t border-gray-200 sm:px-6">
        <div class="flex justify-around items-center max-w-md mx-auto text-sm">
            <a id="homeLink" href="#" class="flex flex-col items-center text-xs text-gray-600 hover:text-primary transition-colors p-3">
                <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 0 0 1 1h3m10-11 2 2m-2-2v10a1 1 0 0 1-1 1h-3m-6 0a1 1 0 0 0 1-1v-4a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1m-6 0h6"></path>
                </svg>
                Home
            </a>
        </div>
    </nav>

    <!-- JavaScript -->
    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        const supabase = createClient(
            'https://lycrgzptkdkksukcwrld.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5Y3JnenB0a2Rra3N1a2N3cmxkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI3ODQyMzAsImV4cCI6MjA2ODM2MDIzMH0.ZJGOXAMC3hKKrnwXHKEa2_Eh7ZpOKeLYvYlYneBiEfk'
        );

        document.addEventListener('DOMContentLoaded', async () => {
            const { data: { user } } = await supabase.auth.getUser();
            const homeLink = document.getElementById('homeLink');
            const isIndexPage = window.location.pathname.endsWith('/index.html');

            if (!user) {
                if (isIndexPage) {
                    homeLink.href = '/index.html';
                } else {
                    homeLink.href = '/login.html';
                }
                return;
            }

            const { data: profile } = await supabase
                .from('profiles')
                .select('ruoli')
                .eq('id', user.id)
                .single();

            const userRoles = profile?.ruoli || [];

            if (userRoles.includes('DIRIGENTE') || userRoles.includes('ADMIN')) {
                homeLink.href = '/app/home_dirigenti.html';
            } else {
                homeLink.href = '/app/home.html';
            }
        });
    </script>
</body>
</html>
